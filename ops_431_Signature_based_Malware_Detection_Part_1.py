#!/usr/bin/env python3

# Script Name:                  Ops 401d8 Challenge 31
# Author:                       David Prutch
# Date of latest revision:      08/21/2023
# Purpose:                      Prompt the user to type in a file name to search for.
                                # Prompt the user for a directory to search in.
                                # Search each file in the directory by name.
                                # TIP: You may need to perform different commands depending on what OS youâ€™re executing the script on.

                                # For each positive detection, print to the screen the file name and location.
                                # At the end of the search process, print to the screen how many files were searched and how many hits were found.

# Import Libraries
import os
import subprocess
from time import sleep
import platform

# Get your system
my_os = platform.system()

# Define Functions
def linux_search():
    filename = input("Enter the file name to search for: ")
    search_directory = input("Enter the directory to search in: ")

    if not os.path.exists(search_directory):
        print("Error: The specified directory does not exist.")
        return

    searched_files = 0
    hits = 0

    for root, _, files in os.walk(search_directory):
        for file in files:
            if file == filename:
                print(f"Found: {filename} at {os.path.join(root, file)}")
                hits += 1
            searched_files += 1

    print("\nSearch completed.")
    print(f"Total files searched: {searched_files}")
    print(f"Total hits found: {hits}")

def windows_search():
    filename = input("Enter the file name to search for: ")
    search_directory = input("Enter the directory to search in: ")

    if not os.path.exists(search_directory):
        print("Error: The specified directory does not exist.")
        return

    cmd = f'dir /s /b {os.path.join(search_directory, filename)}'

    try:
        result = subprocess.check_output(cmd, shell=True, text=True)
        hit_files = result.strip().split('\n')
        if hit_files:
            for file in hit_files:
                print(f"Found: {filename} at {file}")
        else:
            print(f"{filename} not found in the specified directory.")

    except subprocess.CalledProcessError:
        print("An error occurred while searching.")

# Main
if my_os == "Linux":
    linux_search()
elif my_os == "Windows":
    windows_search()
else:
    print("Your OS is not compatible with this script.")
